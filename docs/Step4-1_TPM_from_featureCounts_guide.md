# TPM Calculation (Option B. Alignment-based)

## Tools
- **R** (≥4.0)  
- **readr** (≥2.0)  
- **dplyr** (≥1.0)  

---

## Inputs
- **gene_counts.txt**  
  Output file generated by **featureCounts**, containing:  
  - Annotation columns: `Geneid`, `Chr`, `Start`, `End`, `Strand`, `Length`  
  - Sample-specific raw counts (columns start from column 7)  

---

## Processing
- Extract **gene lengths** from the `Length` column.  
- Compute **Reads Per Kilobase (RPK)** for each gene:  

  `RPK = raw counts / (gene length in kb)`  

- Compute **scaling factor** per sample as the sum of RPK values.  
- Compute **Transcripts Per Million (TPM)** by scaling RPK values:  

  `TPM = (RPK / scaling factor) × 1e6`  

- Combine `Geneid` with TPM matrix.  
- Save the result as a tab-delimited file.  

---

## Outputs
- **tpm_matrix.txt**  
Tab-delimited file containing TPM values for all genes and samples.  
- First column: `Geneid`  
- Following columns: TPM values for each sample  



